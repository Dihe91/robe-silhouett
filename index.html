<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silhouett. | Boutique Officielle & Styliste IA</title>
    
    <!-- Scripts pour faire fonctionner React et le design sans installation -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Polices -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Noto+Sans+Arabic:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #ffffff; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .font-arabic { font-family: 'Noto Sans Arabic', sans-serif; }
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fade-in 1s ease-out forwards; }
        @keyframes slide-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide-up { animation: slide-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        .stylist-modal-enter { transform: translateY(100%); transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .stylist-modal-active { transform: translateY(0); }

        /* Custom scrollbar for stylist response */
        .stylist-advice-scroll::-webkit-scrollbar { width: 3px; }
        .stylist-advice-scroll::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION GEMINI API ---
        const apiKey = ""; // La clé est injectée par l'environnement
        const GEMINI_MODEL = "gemini-2.5-flash-preview-09-2025";

        const callGeminiStylist = async (dressColor, occasion, retries = 0) => {
            const systemPrompt = `Tu es le styliste de mode expert de la maison de haute couture "Silhouett. Paris". 
            Ta mission est de conseiller les clientes sur comment porter la "Robe Stretch Minuit".
            Ton ton doit être luxueux, inspirant, minimaliste et expert.
            Réponds toujours en Français. Ne donne pas de salutations inutiles, va droit au conseil de style.
            Structure ta réponse avec des puces élégantes (Chaussures, Sac, Bijoux, Beauté).`;

            const userPrompt = `Je porte la Robe Stretch Minuit en couleur ${dressColor}. Je vais à : ${occasion}. Comment dois-je l'accessoiriser pour être parfaite ?`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userPrompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });

                if (!response.ok) throw new Error('API Error');
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Désolé, mon inspiration me fait défaut. Réessayez bientôt.";
            } catch (error) {
                if (retries < 5) {
                    const delay = Math.pow(2, retries) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return callGeminiStylist(dressColor, occasion, retries + 1);
                }
                return "Une erreur technique empêche votre styliste de vous répondre. Vérifiez votre connexion.";
            }
        };

        // --- ICONES SVG ---
        const Icons = {
            Menu: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
            ShoppingBag: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>,
            X: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            Globe: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10z"/></svg>,
            Check: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
            Sparkles: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><path d="M12 3l1.912 5.813a2 2 0 001.275 1.275L21 12l-5.813 1.912a2 2 0 00-1.275 1.275L12 21l-1.912-5.813a2 2 0 00-1.275-1.275L3 12l5.813-1.912a2 2 0 001.275-1.275L12 3z"/></svg>
        };

        const TRANSLATIONS = {
            fr: {
                home: "Accueil", cart: "Panier", newSeason: "Nouvelle Collection", heroTitle: "Robe Stretch Minuit",
                discover: "Découvrir", size: "Taille", guide: "Guide des tailles", description: "Description",
                color: "Couleur", addToCart: "Ajouter au panier", buyNow: "Acheter maintenant", added: "Ajouté !",
                stylistBtn: "Conseiller Styliste ✨", stylistTitle: "Votre Styliste Virtuel", stylistPlaceholder: "Quel est l'événement ? (ex: Mariage, Travail...)",
                summary: "Récapitulatif", total: "TOTAL", checkout: "Finaliser la commande", empty: "Votre panier est vide",
                remove: "Supprimer", outOfStock: "Rupture de stock", colors: { black: "Noir", green: "Vert", orange: "Orange" }
            }
        };

        const VARIANTS = {
            black: { hex: "#1a1a1a", mainImage: "https://images.unsplash.com/photo-1539008835657-9e8e9680c956?q=80&w=1887&auto=format&fit=crop", stock: { "XS": 5, "S": 2, "M": 10, "L": 0, "XL": 1 } },
            green: { hex: "#2d4a3e", mainImage: "https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?q=80&w=1887&auto=format&fit=crop", stock: { "XS": 8, "S": 12, "M": 0, "L": 4, "XL": 5 } },
            orange: { hex: "#d66a42", mainImage: "https://images.unsplash.com/photo-1595777457583-95e059d581b8?q=80&w=1887&auto=format&fit=crop", stock: { "XS": 0, "S": 0, "M": 15, "L": 20, "XL": 10 } }
        };

        function App() {
            const [view, setView] = useState('home');
            const [cart, setCart] = useState([]);
            const [selectedVariant, setSelectedVariant] = useState('black');
            const [selectedSize, setSelectedSize] = useState(null);
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [scrolled, setScrolled] = useState(false);
            const [isAdding, setIsAdding] = useState(false);

            // États pour le styliste IA
            const [isStylistOpen, setIsStylistOpen] = useState(false);
            const [stylistOccasion, setStylistOccasion] = useState("");
            const [stylistAdvice, setStylistAdvice] = useState("");
            const [stylistLoading, setStylistLoading] = useState(false);

            const t = TRANSLATIONS.fr;
            const variant = VARIANTS[selectedVariant];

            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            const handleAddToCart = () => {
                if (!selectedSize) return;
                setCart([...cart, { ...variant, size: selectedSize, id: Date.now(), name: "La Robe Stretch" }]);
                setIsAdding(true);
                setTimeout(() => setIsAdding(false), 2000);
            };

            const handleBuyNow = () => {
                if (!selectedSize) return;
                setCart([...cart, { ...variant, size: selectedSize, id: Date.now(), name: "La Robe Stretch" }]);
                setView('cart');
            };

            const askStylist = async () => {
                if (!stylistOccasion) return;
                setStylistLoading(true);
                setStylistAdvice("");
                const advice = await callGeminiStylist(t.colors[selectedVariant], stylistOccasion);
                setStylistAdvice(advice);
                setStylistLoading(false);
            };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <header className={`fixed top-0 w-full z-50 px-6 py-6 flex justify-between items-center transition-all duration-500 ${scrolled || view === 'cart' ? 'bg-white shadow-sm py-4 text-black border-b border-gray-100' : 'bg-transparent text-white'}`}>
                        <div className="flex items-center gap-6">
                            <button onClick={() => setIsMenuOpen(true)} className="hover:opacity-70 transition-transform active:scale-95">
                                <Icons.Menu />
                            </button>
                            <div className="hidden md:flex items-center gap-1 text-[10px] font-bold uppercase tracking-widest cursor-pointer">
                                <Icons.Globe /> FR
                            </div>
                        </div>
                        
                        <h1 onClick={() => setView('home')} className="text-3xl md:text-4xl font-serif font-bold uppercase tracking-tighter cursor-pointer active:scale-95 transition-transform">
                            Silhouett.
                        </h1>

                        <div onClick={() => setView('cart')} className="flex items-center gap-1 cursor-pointer hover:opacity-70 relative transition-transform active:scale-95">
                            <Icons.ShoppingBag />
                            <span className="text-[10px] font-bold">({cart.length})</span>
                        </div>
                    </header>

                    <main className="flex-grow pt-0">
                        {view === 'home' ? (
                            <div className="animate-fade-in">
                                <section className="h-[95vh] bg-gray-100 relative overflow-hidden flex items-center justify-center">
                                    <img src={variant.mainImage} className="absolute inset-0 w-full h-full object-cover opacity-95 transition-all duration-1000" />
                                    <div className="absolute inset-0 bg-black/10"></div>
                                    <div className="relative z-10 text-center text-white p-6 max-w-4xl">
                                        <h2 className="text-6xl md:text-[9rem] font-serif font-bold uppercase mb-12 leading-[0.9] tracking-tighter animate-slide-up">
                                            Robe<br/>Stretch<br/>Minuit
                                        </h2>
                                        <button onClick={() => document.getElementById('boutique').scrollIntoView({behavior:'smooth'})} className="px-14 py-5 border-2 border-white text-[11px] font-bold uppercase tracking-[0.3em] hover:bg-white hover:text-black transition-all">
                                            {t.discover}
                                        </button>
                                    </div>
                                </section>

                                <div id="boutique" className="max-w-7xl mx-auto px-6 grid md:grid-cols-2 gap-20 py-32">
                                    <div className="sticky top-32 h-fit">
                                        <img src={variant.mainImage} className="w-full shadow-2xl rounded-sm transition-opacity duration-500" />
                                    </div>
                                    <div className="flex flex-col justify-center">
                                        <h3 className="text-5xl font-serif font-bold uppercase mb-4 tracking-tighter">La Robe Stretch</h3>
                                        <p className="text-3xl mb-12 font-light text-gray-500 tracking-tight">29.99 EUR</p>
                                        
                                        <p className="text-[11px] font-bold uppercase mb-6 tracking-widest text-gray-400">Coloris : {t.colors[selectedVariant]}</p>
                                        <div className="flex gap-5 mb-14">
                                            {Object.keys(VARIANTS).map(k => (
                                                <button key={k} onClick={() => {setSelectedVariant(k); setSelectedSize(null);}} 
                                                    className={`w-12 h-12 rounded-full border-2 transition-all duration-300 ${selectedVariant === k ? 'border-black scale-110' : 'border-transparent opacity-60 hover:opacity-100'}`}
                                                    style={{backgroundColor: VARIANTS[k].hex}} />
                                            ))}
                                        </div>

                                        <p className="text-[11px] font-bold uppercase mb-6 tracking-widest text-gray-400">{t.size}</p>
                                        <div className="grid grid-cols-5 gap-3 mb-14">
                                            {Object.keys(variant.stock).map(s => (
                                                <button key={s} disabled={variant.stock[s] === 0} onClick={() => setSelectedSize(s)}
                                                    className={`py-5 border text-[11px] font-bold transition-all duration-300 ${selectedSize === s ? 'bg-black text-white border-black shadow-lg' : variant.stock[s] === 0 ? 'opacity-20 cursor-not-allowed' : 'hover:border-black'}`}>{s}</button>
                                            ))}
                                        </div>

                                        <div className="flex flex-col gap-4">
                                            <button 
                                                onClick={handleAddToCart} 
                                                disabled={!selectedSize} 
                                                className={`w-full py-6 text-[11px] font-bold uppercase tracking-[0.3em] transition-all duration-500 flex items-center justify-center gap-2 border-2 ${isAdding ? 'bg-green-600 border-green-600 text-white' : 'bg-white border-black text-black hover:bg-black hover:text-white disabled:opacity-30'}`}
                                            >
                                                {isAdding ? <><Icons.Check /> {t.added}</> : t.addToCart}
                                            </button>
                                            
                                            <button 
                                                onClick={handleBuyNow} 
                                                disabled={!selectedSize} 
                                                className="w-full py-6 bg-black text-white text-[11px] font-bold uppercase tracking-[0.3em] hover:opacity-80 transition-all disabled:opacity-30 shadow-xl"
                                            >
                                                {t.buyNow}
                                            </button>

                                            {/* BOUTON STYLISTE IA ✨ */}
                                            <button 
                                                onClick={() => setIsStylistOpen(true)}
                                                className="w-full py-4 mt-4 border border-dashed border-gray-300 text-[10px] font-bold uppercase tracking-[0.3em] text-gray-500 hover:border-black hover:text-black transition-all flex items-center justify-center gap-2"
                                            >
                                                <Icons.Sparkles /> {t.stylistBtn}
                                            </button>
                                        </div>
                                        
                                        <div className="mt-20 pt-10 border-t border-gray-100">
                                            <p className="text-[10px] font-bold uppercase tracking-widest mb-4">Description</p>
                                            <p className="text-sm leading-relaxed text-gray-400 font-light italic">"Une coupe minimale conçue pour sublimer la ligne sans compromettre le mouvement. Tissu micro-extensible à effet seconde peau."</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="max-w-3xl mx-auto px-6 py-48 text-center animate-fade-in min-h-[70vh]">
                                <h2 className="text-6xl font-serif font-bold uppercase mb-16 border-b border-black pb-10 tracking-tighter">Mon Sac</h2>
                                {cart.length === 0 ? (
                                    <div className="py-20">
                                        <p className="text-gray-400 uppercase tracking-[0.3em] text-xs mb-10">{t.empty}</p>
                                        <button onClick={() => setView('home')} className="px-12 py-5 bg-black text-white text-[10px] font-bold uppercase tracking-widest">Continuer le shopping</button>
                                    </div>
                                ) : (
                                    <div className="space-y-10">
                                        {cart.map(item => (
                                            <div key={item.id} className="flex justify-between items-center border-b border-gray-50 pb-10 group">
                                                <div className="flex items-center gap-8">
                                                    <img src={item.mainImage} className="w-24 h-32 object-cover rounded-sm shadow-md" />
                                                    <div className="text-left">
                                                        <p className="font-bold uppercase text-lg tracking-tighter">Robe Minuit</p>
                                                        <p className="text-[10px] text-gray-400 uppercase tracking-widest mt-1">Taille : {item.size}</p>
                                                    </div>
                                                </div>
                                                <div className="text-right">
                                                    <p className="font-bold text-xl">29.99€</p>
                                                    <button onClick={() => setCart(cart.filter(i => i.id !== item.id))} className="text-[9px] text-red-400 uppercase font-bold mt-4 hover:underline">Retirer</button>
                                                </div>
                                            </div>
                                        ))}
                                        <div className="flex justify-between text-3xl font-bold py-10 border-t border-black mt-10">
                                            <span className="font-serif italic text-gray-300 tracking-widest uppercase text-xs self-center font-normal">Montant Total</span>
                                            <span className="font-serif tracking-tighter">{(cart.length * 29.99).toFixed(2)}€</span>
                                        </div>
                                        <button onClick={() => {alert("Commande confirmée avec succès !"); setCart([]); setView('home');}} className="w-full py-6 bg-black text-white font-bold uppercase text-[11px] tracking-[0.4em] hover:bg-gray-900 transition-all shadow-2xl">
                                            Finaliser la commande
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Footer */}
                    <footer className="py-24 border-t border-gray-50 text-center bg-white">
                        <h2 className="text-4xl font-serif font-bold uppercase tracking-tighter mb-10">Silhouett.</h2>
                        <div className="flex justify-center space-x-12 text-[10px] font-bold uppercase text-gray-300 tracking-[0.4em]">
                           <a href="#" className="hover:text-black transition-colors">Instagram</a>
                           <a href="#" className="hover:text-black transition-colors">Contact</a>
                           <button onClick={() => {setView('home'); window.scrollTo(0,0);}} className="hover:text-black transition-colors uppercase">Légal</button>
                        </div>
                        <p className="mt-16 text-[9px] text-gray-200 uppercase tracking-[0.5em]">Studio Paris • Avenue Montaigne • 2026</p>
                    </footer>

                    {/* PANNEAU STYLISTE IA ✨ */}
                    {isStylistOpen && (
                        <div className="fixed inset-0 z-[110] flex items-end md:items-center justify-center p-0 md:p-6">
                            <div className="absolute inset-0 bg-black/40 backdrop-blur-sm" onClick={() => setIsStylistOpen(false)}></div>
                            <div className="relative bg-white w-full max-w-lg h-[70vh] md:h-auto md:max-h-[85vh] rounded-t-3xl md:rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-slide-up">
                                <div className="p-6 border-b border-gray-100 flex justify-between items-center">
                                    <h3 className="font-serif text-xl uppercase tracking-widest flex items-center gap-2">
                                        <Icons.Sparkles /> {t.stylistTitle}
                                    </h3>
                                    <button onClick={() => setIsStylistOpen(false)} className="p-2 hover:rotate-90 transition-transform"><Icons.X /></button>
                                </div>
                                
                                <div className="flex-grow overflow-y-auto p-6 stylist-advice-scroll">
                                    {!stylistAdvice && !stylistLoading && (
                                        <div className="text-center py-10">
                                            <p className="text-gray-400 text-xs uppercase tracking-widest mb-6">Pour quelle occasion portez-vous la robe {t.colors[selectedVariant]} ?</p>
                                            <div className="flex flex-wrap gap-2 justify-center mb-8">
                                                {["Mariage", "Cocktail", "Dîner Romantique", "Réunion Business", "Vernissage"].map(occ => (
                                                    <button 
                                                        key={occ}
                                                        onClick={() => {setStylistOccasion(occ); askStylist();}}
                                                        className="px-4 py-2 border border-gray-200 rounded-full text-[10px] font-bold uppercase hover:border-black transition-all"
                                                    >
                                                        {occ}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    {stylistLoading && (
                                        <div className="flex flex-col items-center justify-center py-20 text-center">
                                            <div className="w-10 h-10 border-2 border-black border-t-transparent rounded-full animate-spin mb-4"></div>
                                            <p className="text-[10px] font-bold uppercase tracking-[0.2em] animate-pulse">Consultation de votre styliste en cours...</p>
                                        </div>
                                    )}

                                    {stylistAdvice && !stylistLoading && (
                                        <div className="animate-fade-in text-sm leading-relaxed text-gray-700 whitespace-pre-wrap">
                                            <div className="bg-gray-50 p-6 rounded-lg mb-6 border border-gray-100">
                                                <p className="text-[9px] font-bold uppercase text-gray-400 mb-2">Conseil pour : {stylistOccasion}</p>
                                                {stylistAdvice}
                                            </div>
                                            <button 
                                                onClick={() => {setStylistAdvice(""); setStylistOccasion("");}}
                                                className="text-[9px] font-bold uppercase tracking-widest text-black underline underline-offset-4"
                                            >
                                                Demander un autre conseil
                                            </button>
                                        </div>
                                    )}
                                </div>

                                <div className="p-6 bg-gray-50 border-t border-gray-100">
                                    <div className="relative flex gap-2">
                                        <input 
                                            type="text" 
                                            placeholder={t.stylistPlaceholder}
                                            value={stylistOccasion}
                                            onChange={(e) => setStylistOccasion(e.target.value)}
                                            onKeyPress={(e) => e.key === 'Enter' && askStylist()}
                                            className="w-full bg-white border border-gray-200 rounded-lg px-4 py-3 text-xs focus:outline-none focus:border-black transition-all"
                                        />
                                        <button 
                                            onClick={askStylist}
                                            disabled={!stylistOccasion || stylistLoading}
                                            className="bg-black text-white p-3 rounded-lg hover:opacity-80 transition-all disabled:opacity-20"
                                        >
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Menu Latéral */}
                    {isMenuOpen && (
                        <div className="fixed inset-0 z-[100] bg-black/40 backdrop-blur-sm transition-all" onClick={() => setIsMenuOpen(false)}>
                            <div className="absolute top-0 left-0 h-full w-[350px] bg-white p-14 flex flex-col shadow-2xl" onClick={e => e.stopPropagation()}>
                                <button className="self-end mb-24 transition-transform hover:rotate-90" onClick={() => setIsMenuOpen(false)}><Icons.X /></button>
                                <div className="space-y-12 text-5xl font-serif uppercase tracking-tighter">
                                    <button onClick={() => {setView('home'); setIsMenuOpen(false);}} className="block text-left hover:translate-x-4 transition-transform underline-offset-8 hover:underline italic">Collection</button>
                                    <button onClick={() => {setView('home'); setIsMenuOpen(false);}} className="block text-left hover:translate-x-4 transition-transform underline-offset-8 hover:underline italic">Atelier</button>
                                    <button onClick={() => {setView('home'); setIsMenuOpen(false);}} className="block text-left hover:translate-x-4 transition-transform underline-offset-8 hover:underline italic text-gray-300">Archives</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
